<!-- <!DOCTYPE html>
<html>
<head>
    <title>Flask Chatbot</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="chat-container">
    <h2>Flask ChatBot ðŸ¤–</h2>

    <div id="chat-box" class="chat-box"></div>

    <div class="input-area">
        <input type="text" id="user-input" placeholder="Type a message..." autofocus>
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
function sendMessage() {
    let input = document.getElementById("user-input");
    let message = input.value.trim();

    if (message === "") return;

    // Display user's message
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML += `<div class='user-message'>${message}</div>`;

    // Send message to flask
    fetch("/get", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: "message=" + message
    })
    .then(response => response.json())
    .then(data => {
        chatBox.innerHTML += `<div class='bot-message'>${data.reply}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    });

    input.value = "";  // Clear input
}
</script>

</body>
</html> -->


<!-- 
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flask Chatbot</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="chat-container">
    <div class="chat-header">
        <h2>ðŸ¤– Flask ChatBot</h2>
        <button onclick="clearChat()" class="clear-btn">Clear Chat</button>
    </div>

    <div id="chat-box" class="chat-box">
        <div class='bot-message'>Hi! I'm your Flask ChatBot. Type "help" to see what I can do! ðŸ‘‹</div>
    </div>

    <div class="input-area">
        <input type="text" id="user-input" placeholder="Type a message..." autofocus onkeypress="handleKeyPress(event)">
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
function sendMessage() {
    let input = document.getElementById("user-input");
    let message = input.value.trim();

    if (message === "") return;

    // Display user's message
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML += `<div class='user-message'>${escapeHtml(message)}</div>`;

    // Show typing indicator
    chatBox.innerHTML += `<div class='bot-message typing' id='typing'>Bot is typing...</div>`;
    chatBox.scrollTop = chatBox.scrollHeight;

    // Send message to flask
    fetch("/get", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: "message=" + encodeURIComponent(message)
    })
    .then(response => response.json())
    .then(data => {
        // Remove typing indicator
        document.getElementById('typing').remove();
        
        // Add bot response
        chatBox.innerHTML += `<div class='bot-message'>${escapeHtml(data.reply)}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    })
    .catch(error => {
        document.getElementById('typing').remove();
        chatBox.innerHTML += `<div class='bot-message error'>Oops! Something went wrong. Try again.</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    });

    input.value = "";  // Clear input
}

// Allow sending message with Enter key
function handleKeyPress(event) {
    if (event.key === "Enter") {
        sendMessage();
    }
}

// Clear chat history
function clearChat() {
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML = `<div class='bot-message'>Chat cleared! How can I help you? ðŸ˜Š</div>`;
}

// Escape HTML to prevent XSS
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}
</script>

</body>
</html> -->


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BuddyBot - Your Friendly Assistant</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>

<div class="chat-container">
    <div class="chat-header">
        <div class="header-content">
            <div class="bot-avatar">ðŸ¤–</div>
            <div>
                <h2>BuddyBot</h2>
                <span class="status">Online</span>
            </div>
        </div>
        <button onclick="clearChat()" class="clear-btn">Clear</button>
    </div>

    <div id="chat-box" class="chat-box">
        <div class='bot-message'>Hey! I'm BuddyBot ðŸ‘‹ Type "help" to see what I can do!</div>
    </div>

    <div class="input-area">
        <input type="text" id="user-input" placeholder="Type your message here..." autofocus onkeypress="handleKeyPress(event)">
        <button onclick="sendMessage()">Send</button>
    </div>
</div>

<script>
function sendMessage() {
    let input = document.getElementById("user-input");
    let message = input.value.trim();

    if (message === "") return;

    // Display user's message
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML += `<div class='user-message'>${escapeHtml(message)}</div>`;

    // Show typing indicator
    chatBox.innerHTML += `<div class='bot-message typing' id='typing'>BuddyBot is typing...</div>`;
    chatBox.scrollTop = chatBox.scrollHeight;

    // Send message to flask
    fetch("/get", {
        method: "POST",
        headers: {"Content-Type": "application/x-www-form-urlencoded"},
        body: "message=" + encodeURIComponent(message)
    })
    .then(response => response.json())
    .then(data => {
        // Remove typing indicator
        document.getElementById('typing').remove();
        
        // Add bot response
        chatBox.innerHTML += `<div class='bot-message'>${escapeHtml(data.reply)}</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    })
    .catch(error => {
        document.getElementById('typing').remove();
        chatBox.innerHTML += `<div class='bot-message error'>Oops! Something went wrong. Please try again.</div>`;
        chatBox.scrollTop = chatBox.scrollHeight;
    });

    input.value = "";  // Clear input
}

// Allow sending message with Enter key
function handleKeyPress(event) {
    if (event.key === "Enter") {
        sendMessage();
    }
}

// Clear chat history
function clearChat() {
    let chatBox = document.getElementById("chat-box");
    chatBox.innerHTML = `<div class='bot-message'>Chat cleared! How can I help you today? ðŸ˜Š</div>`;
}

// Escape HTML to prevent XSS
function escapeHtml(text) {
    const map = {
        '&': '&amp;',
        '<': '&lt;',
        '>': '&gt;',
        '"': '&quot;',
        "'": '&#039;'
    };
    return text.replace(/[&<>"']/g, m => map[m]);
}
</script>

</body>
</html>